var a=Object.defineProperty;var d=(o,t,e)=>t in o?a(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var l=(o,t,e)=>(d(o,typeof t!="symbol"?t+"":t,e),e);import{I as i}from"./chunk-cb6af00f.js";import{E as h}from"./chunk-d5188a53.js";const y=`
  <div class="text-selection-content">
    <svg class="close-button-content" x="0px" y="0px" width="25" height="25" viewBox="0 0 50 50">
      <path d="M 7.71875 6.28125 L 6.28125 7.71875 L 23.5625 25 L 6.28125 42.28125 L 7.71875 43.71875 L 25 26.4375 L 42.28125 43.71875 L 43.71875 42.28125 L 26.4375 25 L 43.71875 7.71875 L 42.28125 6.28125 L 25 23.5625 Z"></path>
    </svg>
    <p class="text-selection-content-p">{text}</p>
  </div>
`;class m{constructor(){l(this,"section");l(this,"body");this.body=document.querySelector("body"),this.section=document.createElement("section"),this.setupListeners()}setupListeners(){this.body.addEventListener("click",t=>this.handleCloseButtonClick(t)),this.body.addEventListener("keydown",t=>this.handleKeyPress(t)),chrome.runtime.onMessage.addListener((t,e)=>{if(t.message===h.STYLE_UPDATE){const{cssPropertyName:s,className:n}=i[t.key];this.updateElementStyle(t.key,n,s,t.value)}}),chrome.runtime.onMessage.addListener((t,e)=>{t.selectedText.length>1&&(this.buildSection(t.selectedText),this.updateStylesFromLocalStorage())})}handleCloseButtonClick(t){t.target&&t.target.classList.contains("close-button-content")&&this.destroySection()}handleKeyPress(t){if(t.ctrlKey&&t.code==="KeyM"){const e=window.getSelection(),s=e==null?void 0:e.toString().trim();s&&s.length>1&&(this.buildSection(s),this.updateStylesFromLocalStorage())}t.key==="Escape"&&this.destroySection()}updateElementStyle(t,e,s,n){const c=document.querySelector(`.${e}`),r=i[t].unitMeasure||"";if(s==="opacity")return c.style[s]=(parseInt(n)/100).toString();c.style[s]=n+r}async updateStylesFromLocalStorage(){for(const t of Object.keys(i)){const{cssPropertyName:e,className:s}=i[t],n=await this.getItemFromStorage(t);this.updateElementStyle(t,s,e,n)}}toggleHtmlBaseScroll(t){const e=document.querySelector("html");!e||(e.style.overflow=t)}buildSection(t){this.toggleHtmlBaseScroll("hidden"),this.section.classList.add("text-section-parent"),this.body.appendChild(this.section),this.section.innerHTML=y.replace("{text}",t)}clearListeners(){this.body.removeEventListener("click",t=>this.handleCloseButtonClick(t)),this.body.removeEventListener("keydown",t=>this.handleKeyPress(t))}destroySection(){this.toggleHtmlBaseScroll("auto"),this.clearListeners(),this.section.remove()}async getItemFromStorage(t){return(await chrome.storage.local.get([t]))[t]||i[t].default}initialize(){this.setupListeners()}}const u=new m;u.initialize();
